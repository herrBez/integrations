format_version: 3.1.3
name: wmi
title: "WMI Input Package"
version: 0.0.1
source:
  license: "Elastic-2.0"
description: "WMI Input Package"
type: input
categories:
  - observability
conditions:
  kibana:
    version: "^8.19.0 || ^9.1.0"
  elastic:
    subscription: "basic"
screenshots:
  - src: /img/sample-screenshot.png
    title: Sample screenshot
    size: 600x600
    type: image/png
icons:
  - src: /img/logo_windows.svg
    title: Windows logo
    size: 32x32
    type: image/svg+xml
policy_templates:
  - name: wmi
    type: metrics
    title: Collect the Windows metrics via WMI
    description: Collect the Windows metrics via WMI
    input: windows/metrics
    template_path: input.yml.hbs
    vars:
      - name: period
        type: text
        title: Period
        default: 10m
      - name: wmi.namespace
        type: text
        title: Namespace
        multi: false
        required: true
        show_user: true
        default: "root\\cimv2"
        description: WMI Namespace
      - name: wmi.queries
        type: yaml
        title: WMI Queries
        multi: false
        required: true
        show_user: true
        default: |
         # - class: Win32_OperatingSystem
         #   properties:
         #   - FreePhysicalMemory
         #   - FreeSpaceInPagingFiles
         #   - NumberOfUsers
         #   where: ""
         #   # namespace: "root\\cimv2"
        description: >
          Array of queries to execute.
      - name: wmi.warning_threshold
        type: text
        title: Warning Threshold
        multi: false
        required: false
        show_user: false
        description: Default to time-period. Maximum duration to wait for query results before logging a warning. The query will continue running in WMI but will no longer be awaited
      - name: wmi.include_queries
        type: bool
        title: Include Queries
        multi: false
        required: false
        show_user: false     
        description: If enabled the query gets added to the document.   
      - name: wmi.include_null_properties
        type: bool
        title: Include Null Properties
        multi: false
        required: false
        show_user: false     
        description: If enabled the properties with null values gets added to the  document. 
      - name: wmi.include_empty_strings
        type: bool
        title: Include Empty String Properties
        multi: false
        required: false
        show_user: false     
        description: If enabled the properties having empty strings gets added to the  document. 
      - name: data_stream.dataset
        type: text
        title: 'Datastream Dataset name'
        description: Name of Datastream dataset
        multi: false
        default: wmi
        required: true
        show_user: true
      - name: tags
        type: text
        title: Tags
        multi: true
        required: false
        show_user: false
        default: []
      - name: processors
        type: yaml
        title: Processors
        multi: false
        required: false
        show_user: false
        description: >
          Processors are used to reduce the number of fields in the exported event or to enhance the event with metadata. This executes in the agent before the events are shipped. See [Processors](https://www.elastic.co/guide/en/fleet/current/elastic-agent-processor-configuration.html) for details.  
owner:
  github: elastic/obs-infraobs-integrations
  type: elastic
